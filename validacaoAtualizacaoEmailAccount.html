<!-- ...existing code... -->
  <head>
    <meta charset="UTF-8" />
    <title>Documenta√ß√£o T√©cnica - Valida√ß√£o de Email em Account</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- ...existing code... -->

      <div class="section">
        <h3>üèóÔ∏è Estrutura do C√≥digo</h3>

        <h4>1. Trigger: <code>DSP_Account</code></h4>
        <pre><button class="copy-btn" onclick="copyCode(this)">Copiar</button><code>trigger DSP_Account on Account (before insert, before update) {
    new DSP_AccountTriggerHandler(Trigger.new, Trigger.oldMap, Trigger.isInsert, Trigger.isUpdate).run();
}</code></pre>

        <h4>2. Trigger Handler: <code>DSP_AccountTriggerHandler</code></h4>
        <pre><button class="copy-btn" onclick="copyCode(this)">Copiar</button><code>public class DSP_AccountTriggerHandler {
    public void run() {
        if (isUpdate) {
            EPFV_AccountEmailObserver.handle(newList, oldMap);
        }
    }
}</code></pre>

        <h4>3. Observer: <code>EPFV_AccountEmailObserver</code></h4>
        <pre><button class="copy-btn" onclick="copyCode(this)">Copiar</button><code>public class EPFV_AccountEmailObserver {
    public static void handle(List&lt;Account&gt; newList, Map&lt;Id, Account&gt; oldMap) {
        List&lt;Account&gt; changedAccounts = new List&lt;Account&gt;();
        for (Account acc : newList) {
            Account oldAcc = oldMap.get(acc.Id);
            if (acc.Email__c != oldAcc.Email__c) {
                changedAccounts.add(acc);
            }
        }
        new EPFV_ContactExistenceValidator().validate(changedAccounts);
    }
}</code></pre>

        <h4>
          4. Interface Strategy: <code>EPFV_AccountValidationStrategy</code>
        </h4>
        <pre><button class="copy-btn" onclick="copyCode(this)">Copiar</button><code>public interface EPFV_AccountValidationStrategy {
    void validate(List&lt;Account&gt; accounts);
}</code></pre>

        <h4>5. Implementa√ß√£o: <code>EPFV_ContactExistenceValidator</code></h4>
        <pre><button class="copy-btn" onclick="copyCode(this)">Copiar</button><code>public class EPFV_ContactExistenceValidator implements EPFV_AccountValidationStrategy {
    public void validate(List&lt;Account&gt; accounts) {
        Set&lt;Id&gt; accountIds = new Set&lt;Id&gt;();
        for (Account acc : accounts) {
            accountIds.add(acc.Id);
        }

        Map&lt;Id, List&lt;Contact&gt;&gt; contactsByAccount = new Map&lt;Id, List&lt;Contact&gt;&gt;();
        for (Contact c : [SELECT Id, AccountId FROM Contact WHERE AccountId IN :accountIds]) {
            if (!contactsByAccount.containsKey(c.AccountId)) {
                contactsByAccount.put(c.AccountId, new List&lt;Contact&gt;());
            }
            contactsByAccount.get(c.AccountId).add(c);
        }

        for (Account acc : accounts) {
            if (!contactsByAccount.containsKey(acc.Id)) {
                acc.Email__c.addError('N√£o √© poss√≠vel atualizar o Email__c sem contatos relacionados.');
            }
        }
    }
}</code></pre>
      </div>

    <!-- ...existing code... -->

    <script>
      function copyCode(btn) {
        const code = btn.parentElement.querySelector('code');
        let text = code.innerHTML
          .replace(/&lt;/g, "<")
          .replace(/&gt;/g, ">")
          .replace(/&amp;/g, "&");
        navigator.clipboard.writeText(text).then(() => {
          btn.textContent = "Copiado!";
          setTimeout(() => (btn.textContent = "Copiar"), 1200);
        });
      }
    </script>
  </body>
<!-- ...existing code...